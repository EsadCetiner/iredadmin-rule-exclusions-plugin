# Generic rule to disable plugin
SecRule TX:iredadmin-rule-exclusions-plugin "@eq 0" "id:9518010,phase:1,pass,nolog,ctl:ruleRemoveById=9518100-9518999"

# Fix iRedAdmin cookie false positive
# SecAction is used here instead of SecRule since iRedAdmin cookies are always sent regardless of if you are using iRedAdmin or not.
SecAction \
    "id:9518100,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetById=942450;REQUEST_COOKIES:iRedAdmin-MYSQL,\
    ver:'iredadmin-rule-exclusions-plugin/1.0.0'"

# iRedAdmin displays domain names inside the request uri, domains most commonly end in .com which triggers 920440.
SecRule REQUEST_FILENAME "@rx ^/iredadmin/.*\.(?:com|inc)$" \
    "id:9518101,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveById=920440,\
    ver:'iredadmin-rule-exclusions-plugin/1.0.0'"

# logging into iRedAdmin admin panel
SecRule REQUEST_FILENAME "@streq /iredadmin/login" \
    "id:9518102,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:password,\
    ver:'iredadmin-rule-exclusions-plugin/1.0.0'"

# When creating a new iRedMail user
SecRule REQUEST_FILENAME "@beginsWith /iredadmin/create/user/" \
    "id:9518103,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetById=932260;ARGS_NAMES:mailQuota,\
    ctl:ruleRemoveTargetById=932236;ARGS_NAMES:mailQuota,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:confirmpw,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:newpw,\
    ver:'iredadmin-rule-exclusions-plugin/1.0.0'"

# When making changes to an existing iRedMail user or Administrator
SecRule REQUEST_FILENAME "@beginsWith /iredadmin/profile/user/general/" \
    "id:9518104,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetById=932260;ARGS_NAMES:mailQuota,\
    ctl:ruleRemoveTargetById=932236;ARGS_NAMES:mailQuota,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:confirmpw,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:newpw,\
    ver:'iredadmin-rule-exclusions-plugin/1.0.0'"

# When adding a new iRedMail Administrator
SecRule REQUEST_FILENAME "@streq /iredadmin/create/admin" \
    "id:9518105,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetById=932236;ARGS_NAMES:mail,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:confirmpw,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:newpw,\
    ver:'iredadmin-rule-exclusions-plugin/1.0.0'"

# When changing a iRedMail user's password
SecRule REQUEST_FILENAME "@beginsWith /iredadmin/profile/user/password/" \
    "id:9518106,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:confirmpw,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:newpw,\
    ver:'iredadmin-rule-exclusions-plugin/1.0.0'"

# When enabling/disabing/deleting iRedMail users
SecRule REQUEST_FILENAME "@rx ^/iredadmin/users/.*/page/[0-9]*$" \
    "id:9518107,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetById=932236;ARGS_NAMES:mail,\
    ver:'iredadmin-rule-exclusions-plugin/1.0.0'"

# When enabling/disabing/deleting iRedMail administrators
SecRule REQUEST_FILENAME "@streq /iredadmin/admins" \
    "id:9518108,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetById=932236;ARGS_NAMES:mail,\
    ver:'iredadmin-rule-exclusions-plugin/1.0.0'"

# iRedAdmin can sometimes set a funny referrer
SecRule REQUEST_FILENAME "@beginsWith /iredadmin/" \
    "id:9518109,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetById=932237;REQUEST_HEADERS:referer,\
    ver:'iredadmin-rule-exclusions-plugin/1.0.0'"
